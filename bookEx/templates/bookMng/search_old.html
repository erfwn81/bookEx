{% extends "base.html" %}

{% block sidenav %}
  {% for item in item_list %}
    <li><a href="{{ item.link }}">{{ item.item }}</a></li>
  {% endfor %}
{% endblock sidenav %}

{% block content %}
  <h1>Search a Book</h1>

  <form method="get" action="{% url 'search' %}" style="margin: 12px 0;">
    <input name="q" value="{{ q }}" placeholder="Type book name or web..." style="padding:6px; width:280px;">
    <button type="submit">Search</button>
  </form>

  {% if q %}
    {% if results %}
      <table border="1" cellpadding="6" cellspacing="0">
        <tr>
          <th>Book Name</th>
          <th>Book Price</th>
          <th>User Name</th>
          <th>Actions</th>
        </tr>
        {% for b in results %}
          <tr>
            <td><a href="{% url 'book_detail' b.id %}">{{ b.name }}</a></td>
            <td>{% if b.price %}${{ b.price|floatformat:"2" }}{% else %}-{% endif %}</td>
            <td>{% if b.username %}{{ b.username.username }}{% else %}-{% endif %}</td>
            <td>
              <a href="{% url 'cart_add' b.id %}">Add to cart</a>
              {% if user.is_authenticated and b.username_id == user.id %}
                &nbsp;|&nbsp; <a href="{% url 'book_delete' b.id %}">DELETE</a>
              {% endif %}
            </td>
          </tr>
        {% endfor %}
      </table>
    {% else %}
      <p>No matches found for <strong>{{ q }}</strong>.</p>
    {% endif %}
  {% else %}
    <p>Enter a keyword and press Search.</p>
  {% endif %}
{% endblock content %}
